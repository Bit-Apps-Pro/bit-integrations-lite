{"version":3,"file":"bi.62.692.js","sources":["../frontend-dev/src/components/Utilities/TagifyInput.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\nimport Tagify from '@yaireo/tagify'\nimport '@yaireo/tagify/dist/tagify.css'\nimport { useEffect, useRef } from 'react';\n\nfunction TagifyInput({ label, onChange, value, disabled, type, textarea, className ,formFields }) {\n  const fields = formFields ? formFields.filter(itm => itm.label !== undefined).map(item => ({ name: item.label, value: item.name })) : []\n\n  const targetRef = useRef(null)\n\n  const tagifyRef = useRef(null)\n\n  useEffect(() => {\n    const input = targetRef.current\n    input.value = value\n    input.setAttribute('value', value)\n    if (tagifyRef.current) {\n      tagifyRef.current.destroy()\n    }\n    tagifyRef.current = new Tagify(input, tagifySettings)\n    tagifyRef.current.DOM.originalInput.value = value\n\n    tagifyRef.current.on('input', onInput)\n    tagifyRef.current.on('add', onAddTag)\n    tagifyRef.current.on('remove', onRemoveTag)\n  }, [])\n\n  const modifyTagifyData = val => {\n    const matchedBraces = val.match(/(\\${{.*?\"value\":\".*?)\"}}/g)\n    let replacedData = val\n    if (matchedBraces) {\n      matchedBraces.forEach(item => {\n        const itm = item.slice(2, -1)\n        const parseData = JSON.parse(itm)\n        replacedData = replacedData.replace(item, `\\${${parseData.value}}`)\n      })\n    }\n    onChange(replacedData)\n  }\n\n  const onInput = (e) => {\n    const { prefix, textContent } = e.detail\n    const lastChar = textContent.slice(-1)\n    const isLastCharPrefix = lastChar === '#'\n    const pref = isLastCharPrefix ? lastChar : prefix\n    if (pref) {\n      if (pref === '#') {\n        tagifyRef.current.whitelist = fields\n      }\n      tagifyRef.current.dropdown.show()\n    }\n\n    setTimeout(() => {\n      modifyTagifyData(e.detail.tagify.DOM.originalInput.value)\n    }, 100)\n\n  }\n\n  const onAddTag = e => {\n    setTimeout(() => {\n      modifyTagifyData(e.detail.tagify.DOM.originalInput.value)\n    }, 100)\n  }\n\n  const onRemoveTag = e => {\n    setTimeout(() => {\n      modifyTagifyData(e.detail.tagify.DOM.originalInput.value)\n    }, 100)\n  }\n\n  const tagifySettings = {\n    mixTagsInterpolator: ['${', '}'],\n    mode: 'mix', \n    mixMode: { insertAfterTag: ' ' },\n    pattern:  /#/,\n    placeholder: label,\n    tagTextProp: 'value',\n    duplicates: true,\n    whitelist: fields,\n    enforceWhitelist: true,\n    trim: true,\n    editTags: false,\n    dropdown: {\n      enabled: 0,\n      position: 'text',\n      mapValueTo: 'value',\n      highlightFirst: true,\n      searchKeys: ['label', 'value'],\n      closeOnSelect: true,\n      placeAbove: false,\n    },\n    callbacks: {\n      add: () => {\n        modifyTagifyData(tagifyRef.current.DOM.originalInput.value)\n      },\n      remove: () => {\n        modifyTagifyData(tagifyRef.current.DOM.originalInput.value)\n      },\n    },\n  }\n  return (\n    <div>\n      <input name=\"tagify-inp\" type={type === undefined ? 'text' : type} ref={targetRef} />\n      {/* <span>{ddiv}</span> */}\n    </div>\n  )\n}\n\nexport default TagifyInput\n"],"names":["reactExports","jsxRuntimeExports","Tagify","TagifyInput","label","onChange","value","disabled","type","textarea","className","formFields","fields","itm","item","targetRef","useRef","tagifyRef","useEffect","input","tagifySettings","onInput","onAddTag","onRemoveTag","modifyTagifyData","val","matchedBraces","replacedData","parseData","prefix","textContent","lastChar","pref","jsx"],"mappings":"AAKA,OAAA,KAAAA,EAAA,KAAAC,MAAA,gBAAA,OAAA,KAAAC,MAAA,kBAAA,SAASC,EAAY,CAAE,MAAAC,EAAO,SAAAC,EAAU,MAAAC,EAAO,SAAAC,EAAU,KAAAC,EAAM,SAAAC,EAAU,UAAAC,EAAW,WAAAC,GAAc,CAC1F,MAAAC,EAASD,EAAaA,EAAW,UAAcE,EAAI,QAAU,MAAS,EAAE,QAAa,CAAE,KAAMC,EAAK,MAAO,MAAOA,EAAK,IAAK,EAAE,EAAI,GAEhIC,EAAYC,SAAO,IAAI,EAEvBC,EAAYD,SAAO,IAAI,EAE7BE,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAQJ,EAAU,QACxBI,EAAM,MAAQb,EACRa,EAAA,aAAa,QAASb,CAAK,EAC7BW,EAAU,SACZA,EAAU,QAAQ,UAEpBA,EAAU,QAAU,IAAIf,EAAOiB,EAAOC,CAAc,EAC1CH,EAAA,QAAQ,IAAI,cAAc,MAAQX,EAElCW,EAAA,QAAQ,GAAG,QAASI,CAAO,EAC3BJ,EAAA,QAAQ,GAAG,MAAOK,CAAQ,EAC1BL,EAAA,QAAQ,GAAG,SAAUM,CAAW,CAC5C,EAAG,CAAE,CAAA,EAEL,MAAMC,EAA0BC,GAAA,CACxB,MAAAC,EAAgBD,EAAI,MAAM,2BAA2B,EAC3D,IAAIE,EAAeF,EACfC,GACFA,EAAc,QAAgBZ,GAAA,CAC5B,MAAMD,EAAMC,EAAK,MAAM,EAAG,EAAE,EACtBc,EAAY,KAAK,MAAMf,CAAG,EAChCc,EAAeA,EAAa,QAAQb,EAAM,MAAMc,EAAU,KAAK,GAAG,CAAA,CACnE,EAEHvB,EAASsB,CAAY,CAAA,EAGjBN,EAAW,GAAM,CACrB,KAAM,CAAE,OAAAQ,EAAQ,YAAAC,GAAgB,EAAE,OAC5BC,EAAWD,EAAY,MAAM,EAAE,EAE/BE,EADmBD,IAAa,IACNA,EAAWF,EACvCG,IACEA,IAAS,MACXf,EAAU,QAAQ,UAAYL,GAEtBK,EAAA,QAAQ,SAAS,QAG7B,WAAW,IAAM,CACfO,EAAiB,EAAE,OAAO,OAAO,IAAI,cAAc,KAAK,GACvD,GAAG,CAAA,EAIFF,EAAgB,GAAA,CACpB,WAAW,IAAM,CACfE,EAAiB,EAAE,OAAO,OAAO,IAAI,cAAc,KAAK,GACvD,GAAG,CAAA,EAGFD,EAAmB,GAAA,CACvB,WAAW,IAAM,CACfC,EAAiB,EAAE,OAAO,OAAO,IAAI,cAAc,KAAK,GACvD,GAAG,CAAA,EAGFJ,EAAiB,CACrB,oBAAqB,CAAC,KAAM,GAAG,EAC/B,KAAM,MACN,QAAS,CAAE,eAAgB,GAAI,EAC/B,QAAU,IACV,YAAahB,EACb,YAAa,QACb,WAAY,GACZ,UAAWQ,EACX,iBAAkB,GAClB,KAAM,GACN,SAAU,GACV,SAAU,CACR,QAAS,EACT,SAAU,OACV,WAAY,QACZ,eAAgB,GAChB,WAAY,CAAC,QAAS,OAAO,EAC7B,cAAe,GACf,WAAY,EACd,EACA,UAAW,CACT,IAAK,IAAM,CACTY,EAAiBP,EAAU,QAAQ,IAAI,cAAc,KAAK,CAC5D,EACA,OAAQ,IAAM,CACZO,EAAiBP,EAAU,QAAQ,IAAI,cAAc,KAAK,CAC5D,CACF,CAAA,EAEF,OACGgB,EAAAA,IAAA,MAAA,CACC,SAACA,EAAAA,IAAA,QAAA,CAAM,KAAK,aAAa,KAAMzB,IAAS,OAAY,OAASA,EAAM,IAAKO,EAAW,CAErF,CAAA,CAEJ"}