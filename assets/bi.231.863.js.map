{"version":3,"file":"bi.231.863.js","sources":["../frontend-dev/src/components/AllIntegrations/MasterStudyLms/MasterStudyLmsCommonFunc.js","../frontend-dev/src/components/AllIntegrations/MasterStudyLms/MasterStudyLmsIntegLayout.jsx"],"sourcesContent":["import toast from 'react-hot-toast'\nimport bitsFetch from '../../../Utils/bitsFetch'\nimport { deepCopy } from '../../../Utils/Helpers'\nimport { sprintf, __ } from '../../../Utils/i18nwrap'\n\nexport const handleInput = (e, msLmsConf, setMsLmsConf, setIsLoading, setSnackbar, formID) => {\n  const newConf = { ...msLmsConf }\n  const { name } = e.target\n  if (e.target.value !== '') {\n    newConf[name] = e.target.value\n  } else {\n    delete newConf[name]\n  }\n  newConf[e.target.name] = e.target.value\n  setMsLmsConf({ ...newConf })\n}\n\nexport const generateMappedField = (msLmsConf) => {\n  const requiredFlds = msLmsConf?.createGroupFields.filter(fld => fld.required === true)\n  return requiredFlds.length > 0 ? requiredFlds.map(field => ({ formField: '', msLmsFormField: field.key })) : [{ formField: '', msLmsFormField: '' }]\n}\n\nexport const checkMappedFields = (msLmsConf) => {\n  const mappedFleld = msLmsConf.field_map ? msLmsConf.field_map.filter(mapped => (!mapped.formField && !mapped.msLmsFormField)) : []\n  if (mappedFleld.length > 0) {\n    return false\n  }\n  return true\n}\n\nexport const fetchAllMsLmsCourse = (msLmsConf, setMsLmsConf, setIsLoading, setSnackbar) => {\n  setIsLoading(true)\n  const queryPrarms = { courseId: msLmsConf.courseId }\n  bitsFetch({}, 'mslms_fetch_all_course')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...msLmsConf }\n        if (!newConf.default) {\n          newConf.default = {}\n        }\n        if (result.data) {\n          newConf.default.allCourse = result.data\n        }\n        setMsLmsConf({ ...newConf })\n        setIsLoading(false)\n        toast.success(__('Course fetched successfully', 'bit-integrations'))\n        return\n      }\n      setIsLoading(false)\n      toast.error(__('Course fetch failed. please try again', 'bit-integrations'))\n    })\n\n    .catch(() => setIsLoading(false))\n}\n\nexport const fetchAllLesson = (msLmsConf, setMsLmsConf, setIsLoading, setSnackbar) => {\n  setIsLoading(true)\n  const queryPrarms = { courseId: msLmsConf.courseId }\n  bitsFetch(queryPrarms, 'msLms_fetch_all_lesson')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...msLmsConf }\n        if (!newConf.default) {\n          newConf.default = {}\n        }\n        if (result.data) {\n          newConf.default.allLesson = result.data\n        }\n        setMsLmsConf({ ...newConf })\n        setIsLoading(false)\n        toast.success(__('Lesson fetched successfully', 'bit-integrations'))\n        return\n      }\n      setIsLoading(false)\n      toast.error(__('Lesson fetch failed. please try again', 'bit-integrations'))\n    })\n    .catch(() => setIsLoading(false))\n}\n\nexport const fetchAllQuiz = (msLmsConf, setMsLmsConf, setIsLoading, setSnackbar) => {\n  setIsLoading(true)\n  const queryPrarms = { courseId: msLmsConf.courseId }\n  bitsFetch(queryPrarms, 'msLms_fetch_all_quiz')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...msLmsConf }\n        if (!newConf.default) {\n          newConf.default = {}\n        }\n        if (result.data) {\n          newConf.default.allQuiz = result.data\n        }\n        setMsLmsConf({ ...newConf })\n        setIsLoading(false)\n        toast.success(__('Quiz fetched successfully', 'bit-integrations'))\n        return\n      }\n      setIsLoading(false)\n      toast.error(__('Quiz fetch failed. please try again', 'bit-integrations'))\n    })\n    .catch(() => setIsLoading(false))\n}","import { useEffect } from 'react'\nimport MultiSelect from 'react-multiple-select-dropdown-lite'\nimport { __ } from '../../../Utils/i18nwrap'\nimport Loader from '../../Loaders/Loader'\nimport { addFieldMap } from '../IntegrationHelpers/IntegrationHelpers'\nimport { fetchAllLesson, fetchAllMsLmsCourse, fetchAllQuiz } from './MasterStudyLmsCommonFunc'\nimport Note from '../../Utilities/Note'\n\nexport default function MasterStudyLmsIntegLayout({ formFields, handleInput, msLmsConf, setMsLmsConf, isLoading, setIsLoading, setSnackbar, allIntegURL, isInfo, edit }) {\n  useEffect(() => {\n    if (['1', '2', '3', '4', '5'].includes(msLmsConf.mainAction)) {\n      fetchAllMsLmsCourse(msLmsConf, setMsLmsConf, setIsLoading, setSnackbar)\n    }\n  }, [msLmsConf.mainAction])\n\n  const changeHandler = (val, status) => {\n    const newConf = { ...msLmsConf }\n    if (val !== '') {\n      newConf[status] = val\n      if (msLmsConf.mainAction === '2' || msLmsConf.mainAction === '5') {\n        fetchAllLesson(newConf, setMsLmsConf, setIsLoading, setSnackbar)\n      }\n      if (msLmsConf.mainAction === '3') {\n        fetchAllQuiz(newConf, setMsLmsConf, setIsLoading, setSnackbar)\n      }\n    } else {\n      delete newConf[status]\n    }\n    setMsLmsConf({ ...newConf })\n  }\n  return (\n    <>\n      <br />\n      <b className=\"wdt-200 d-in-b\">{__('Actions:', 'bit-integrations')}</b>\n      <select onChange={handleInput} name=\"mainAction\" value={msLmsConf.mainAction} className=\"btcd-paper-inp w-5\">\n        <option value=\"\">{__('Select Actions', 'bit-integrations')}</option>\n        {\n          msLmsConf.allActions && msLmsConf.allActions.map(({ key, label }) => (\n            <option key={key} value={key}>\n              {label}\n            </option>\n          ))\n        }\n      </select>\n      <br />\n      <br />\n      {(['1', '2', '3', '4', '5'].includes(msLmsConf.mainAction)) && (\n        <div className=\"flx mt-4\">\n          <b className=\"wdt-200 d-in-b\">{__('Select a Course: ', 'bit-integrations')}</b>\n          <MultiSelect\n            className=\"w-5\"\n            singleSelect\n            defaultValue={msLmsConf?.courseId}\n            options={msLmsConf?.default?.allCourse && msLmsConf.default.allCourse.map((item) => ({ label: item.post_title, value: item.ID.toString() }))}\n            onChange={(val) => changeHandler(val, 'courseId')}\n          />\n          <button onClick={() => fetchAllCourse(msLmsConf, setMsLmsConf, setIsLoading, setSnackbar)} className=\"icn-btn sh-sm ml-2 mr-2 tooltip\" style={{ '--tooltip-txt': `'${__('Fetch course list', 'bit-integrations')}'` }} type=\"button\" disabled={isLoading}>&#x21BB;</button>\n        </div>\n      )}\n      {((msLmsConf.mainAction === '2' || msLmsConf.mainAction === '5') && msLmsConf?.courseId) && (\n        <div className=\"flx mt-4\">\n          <b className=\"wdt-200 d-in-b\">{__('Select lesson: ', 'bit-integrations')}</b>\n          <MultiSelect\n            className=\"w-5\"\n            singleSelect\n            defaultValue={msLmsConf?.lessonId}\n            options={msLmsConf?.default?.allLesson && msLmsConf.default.allLesson.map((item) => ({ label: item.post_title, value: item.ID.toString() }))}\n            onChange={(val) => changeHandler(val, 'lessonId')}\n          />\n          <button onClick={() => fetchAllLesson(msLmsConf, setMsLmsConf, setIsLoading, setSnackbar)} className=\"icn-btn sh-sm ml-2 mr-2 tooltip\" style={{ '--tooltip-txt': `'${__('Fetch lesson list', 'bit-integrations')}'` }} type=\"button\" disabled={isLoading}>&#x21BB;</button>\n        </div>\n      )}\n      {(msLmsConf.mainAction === '3' && msLmsConf?.courseId) && (\n        <div className=\"flx mt-4\">\n          <b className=\"wdt-200 d-in-b\">{__('Select quiz: ', 'bit-integrations')}</b>\n          <MultiSelect\n            className=\"w-5\"\n            singleSelect\n            defaultValue={msLmsConf?.quizId}\n            options={msLmsConf?.default?.allQuiz && msLmsConf.default.allQuiz.map((item) => ({ label: item.post_title, value: item.ID.toString() }))}\n            onChange={(val) => changeHandler(val, 'quizId')}\n          />\n          <button onClick={() => fetchAllQuiz(msLmsConf, setMsLmsConf, setIsLoading, setSnackbar)} className=\"icn-btn sh-sm ml-2 mr-2 tooltip\" style={{ '--tooltip-txt': `'${__('Fetch quiz list', 'bit-integrations')}'` }} type=\"button\" disabled={isLoading}>&#x21BB;</button>\n        </div>\n      )}\n\n      <br />\n      <br />\n      {isLoading && (\n        <Loader style={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: 100,\n          transform: 'scale(0.7)',\n        }}\n        />\n      )}\n      <Note\n        note=\"This integration will only work for logged-in users.\"\n      />\n    </>\n  )\n}\n"],"names":["reactExports","jsxRuntimeExports","Loader","bitsFetch","_t","__","u","Note","handleInput","e","msLmsConf","setMsLmsConf","setIsLoading","setSnackbar","formID","newConf","__spreadValues","name","fetchAllMsLmsCourse","result","toast","fetchAllLesson","queryPrarms","fetchAllQuiz","MasterStudyLmsIntegLayout","formFields","isLoading","allIntegURL","isInfo","edit","_a","_b","_c","useEffect","changeHandler","val","status","jsxs","Fragment","jsx","key","label","MultiSelect","item"],"mappings":"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"}