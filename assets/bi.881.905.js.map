{"version":3,"file":"bi.881.905.js","sources":["../frontend-dev/src/components/AllIntegrations/OneHashCRM/OneHashCRMCommonFunc.js"],"sourcesContent":["/* eslint-disable no-console */\n/* eslint-disable no-else-return */\nimport toast from \"react-hot-toast\";\nimport bitsFetch from \"../../../Utils/bitsFetch\";\nimport { __ } from \"../../../Utils/i18nwrap\";\n\nexport const handleInput = (e, oneHashCRMConf, setOneHashCRMConf) => {\n  const newConf = { ...oneHashCRMConf };\n  const { name } = e.target;\n  if (e.target.value !== \"\") {\n    newConf[name] = e.target.value;\n  } else {\n    delete newConf[name];\n  }\n  setOneHashCRMConf({ ...newConf });\n};\n\nexport const generateMappedField = (oneHashCRMConf) => {\n  const requiredFlds =\n    oneHashCRMConf?.oneHashCRMFields &&\n    oneHashCRMConf?.oneHashCRMFields.filter(\n      (fld) =>\n        fld.required === true && fld.key !== \"owner\" && fld.key !== \"pipeline\"\n    );\n  return requiredFlds.length > 0\n    ? requiredFlds.map((field) => ({\n        formField: \"\",\n        oneHashCRMFormField: field.key,\n      }))\n    : [{ formField: \"\", oneHashCRMFormField: \"\" }];\n};\n\nexport const checkMappedFields = (oneHashCRMConf) => {\n  const mappedFields = oneHashCRMConf?.field_map\n    ? oneHashCRMConf.field_map.filter(\n        (mappedField) =>\n          !mappedField.formField ||\n          !mappedField.oneHashCRMFormField ||\n          (mappedField.formField === \"custom\" && !mappedField.customValue) ||\n          (mappedField.oneHashCRMFormField === \"customFieldKey\" &&\n            !mappedField.customFieldKey)\n      )\n    : [];\n  if (mappedFields.length > 0) {\n    return false;\n  }\n  return true;\n};\n\nexport const oneHashCRMAuthentication = (\n  confTmp,\n  setConf,\n  setError,\n  setIsAuthorized,\n  loading,\n  setLoading\n) => {\n  if (!confTmp.api_key || !confTmp.api_secret || !confTmp.domain) {\n    setError({\n      api_key: !confTmp.api_key\n        ? __(\"Api Key can't be empty\", \"bit-integrations\")\n        : \"\",\n      api_secret: !confTmp.api_secret\n        ? __(\"Api Secret can't be empty\", \"bit-integrations\")\n        : \"\",\n      domain: !confTmp.domain\n        ? __(\"Access API URL can't be empty\", \"bit-integrations\")\n        : \"\",\n    });\n    return;\n  }\n\n  setError({});\n  setLoading({ ...loading, auth: true });\n\n  const requestParams = {\n    api_key: confTmp.api_key,\n    api_secret: confTmp.api_secret,\n    domain: confTmp.domain,\n  };\n\n  bitsFetch(requestParams, \"onehashcrm_authentication\").then((result) => {\n    if (result && result.success) {\n      setIsAuthorized(true);\n      setLoading({ ...loading, auth: false });\n      toast.success(__(\"Authorized successfully\", \"bit-integrations\"));\n      return;\n    }\n    setLoading({ ...loading, auth: false });\n    toast.error(\n      __(\n        \"Authorized failed, Please enter valid API Key & Secret or Access Api URL\",\n        \"bit-integrations\"\n      )\n    );\n  });\n};\n"],"names":["__","bitsFetch","_t","handleInput","oneHashCRMConf","setOneHashCRMConf","newConf","__spreadValues","name","generateMappedField","requiredFlds","fld","field","checkMappedFields","mappedField","oneHashCRMAuthentication","confTmp","setConf","setError","setIsAuthorized","loading","setLoading","__spreadProps","requestParams","result","toast"],"mappings":"6aAAA,OAAA,KAAAA,EAAA,KAAAC,EAAA,KAAAC,MAAA,iBAMY,MAACC,EAAc,CAAC,EAAGC,EAAgBC,IAAsB,CACnE,MAAMC,EAAUC,EAAA,GAAKH,GACf,CAAE,KAAAI,CAAI,EAAK,EAAE,OACf,EAAE,OAAO,QAAU,GACrBF,EAAQE,CAAI,EAAI,EAAE,OAAO,MAEzB,OAAOF,EAAQE,CAAI,EAErBH,EAAkBE,EAAA,GAAKD,EAAS,CAClC,EAEaG,EAAuBL,GAAmB,CACrD,MAAMM,GACJN,GAAA,YAAAA,EAAgB,oBAChBA,GAAA,YAAAA,EAAgB,iBAAiB,OAC9BO,GACCA,EAAI,WAAa,IAAQA,EAAI,MAAQ,SAAWA,EAAI,MAAQ,aAElE,OAAOD,EAAa,OAAS,EACzBA,EAAa,IAAKE,IAAW,CAC3B,UAAW,GACX,oBAAqBA,EAAM,GACnC,EAAQ,EACF,CAAC,CAAE,UAAW,GAAI,oBAAqB,EAAI,CAAA,CACjD,EAEaC,EAAqBT,GAW5B,GAViBA,GAAA,MAAAA,EAAgB,UACjCA,EAAe,UAAU,OACtBU,GACC,CAACA,EAAY,WACb,CAACA,EAAY,qBACZA,EAAY,YAAc,UAAY,CAACA,EAAY,aACnDA,EAAY,sBAAwB,kBACnC,CAACA,EAAY,cAClB,EACD,IACa,OAAS,GAMfC,EAA2B,CACtCC,EACAC,EACAC,EACAC,EACAC,EACAC,IACG,CACH,GAAI,CAACL,EAAQ,SAAW,CAACA,EAAQ,YAAc,CAACA,EAAQ,OAAQ,CAC9DE,EAAS,CACP,QAAUF,EAAQ,QAEd,GADAhB,EAAG,yBAA0B,kBAAkB,EAEnD,WAAagB,EAAQ,WAEjB,GADAhB,EAAG,4BAA6B,kBAAkB,EAEtD,OAASgB,EAAQ,OAEb,GADAhB,EAAG,gCAAiC,kBAAkB,CAEhE,CAAK,EACD,MACD,CAEDkB,EAAS,CAAE,CAAA,EACXG,EAAWC,EAAAf,EAAA,GAAKa,GAAL,CAAc,KAAM,EAAM,EAAA,EAErC,MAAMG,EAAgB,CACpB,QAASP,EAAQ,QACjB,WAAYA,EAAQ,WACpB,OAAQA,EAAQ,MACpB,EAEEf,EAAUsB,EAAe,2BAA2B,EAAE,KAAMC,GAAW,CACrE,GAAIA,GAAUA,EAAO,QAAS,CAC5BL,EAAgB,EAAI,EACpBE,EAAWC,EAAAf,EAAA,GAAKa,GAAL,CAAc,KAAM,EAAO,EAAA,EACtCK,EAAM,QAAQzB,EAAG,0BAA2B,kBAAkB,CAAC,EAC/D,MACD,CACDqB,EAAWC,EAAAf,EAAA,GAAKa,GAAL,CAAc,KAAM,EAAO,EAAA,EACtCK,EAAM,MACJzB,EACE,2EACA,kBACD,CACP,CACA,CAAG,CACH"}