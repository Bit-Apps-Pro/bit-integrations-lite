{"version":3,"file":"bi.433.783.js","sources":["../frontend-dev/src/components/AllIntegrations/SendFox/SendFoxCommonFunc.js"],"sourcesContent":["import toast from 'react-hot-toast'\nimport bitsFetch from '../../../Utils/bitsFetch'\nimport { deepCopy } from '../../../Utils/Helpers'\nimport { sprintf, __ } from '../../../Utils/i18nwrap'\n\nexport const handleInput = (e, sendFoxConf, setSendFoxConf, setIsLoading, setSnackbar, formID) => {\n  const newConf = { ...sendFoxConf }\n  const { name } = e.target\n  if (e.target.value !== '') {\n    newConf[name] = e.target.value\n  } else {\n    delete newConf[name]\n  }\n  if (newConf.mainAction === '2') {\n    fetchAllList(newConf, setSendFoxConf, setIsLoading, setSnackbar)\n  }\n  setSendFoxConf({ ...newConf })\n}\n\nexport const checkAddressFieldMapRequired = sendFoxConf => {\n  const requiredFleld = sendFoxConf?.address_field ? sendFoxConf.default?.fields.filter(field => !field.formField && field.acumbamailFormField && field.required) : []\n  if (requiredFleld.length > 0) {\n    return false\n  }\n  return true\n}\n\nexport const fetchAllList = (sendFoxConf, setSendFoxConf, setIsLoading, setSnackbar) => {\n  setIsLoading(true)\n  const requestParams = { access_token: sendFoxConf.access_token }\n\n  bitsFetch(requestParams, 'sendfox_fetch_all_list')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...sendFoxConf }\n        if (!newConf.default) {\n          newConf.default = {}\n        }\n        if (result.data) {\n          newConf.default.allLists = result.data.data\n        }\n        setSendFoxConf({ ...newConf })\n        setIsLoading(false)\n        toast.success(__('Lists fetched successfully', 'bit-integrations'))\n        return\n      }\n      setIsLoading(false)\n      toast.error(__('Lists fetch failed. please try again', 'bit-integrations'))\n    })\n\n    .catch(() => setIsLoading(false))\n}\n\nexport const handleAuthorize = (confTmp, setConf, setError, setisAuthorized, setIsLoading, setSnackbar) => {\n  if (!confTmp.access_token) {\n    setError({ access_token: !confTmp.access_token ? __('Access Token can\\'t be empty', 'bit-integrations') : '' })\n    return\n  }\n  setError({})\n  setIsLoading(true)\n\n  const requestParams = { access_token: confTmp.access_token }\n\n  bitsFetch(requestParams, 'sendFox_authorize')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...confTmp }\n        setConf(newConf)\n        setisAuthorized(true)\n        setIsLoading(false)\n        toast.success(__('Authorized successfully', 'bit-integrations'))\n        return\n      }\n      setIsLoading(false)\n      toast.error(__('Authorized failed', 'bit-integrations'))\n    })\n}\n\nexport const generateMappedField = (sendFoxConf) => {\n  const requiredFlds = sendFoxConf?.contactFields.filter(fld => fld.required === true)\n  return requiredFlds.length > 0 ? requiredFlds.map(field => ({ formField: '', sendFoxFormField: field.key })) : [{ formField: '', sendFoxFormField: '' }]\n}\n\nexport const checkMappedFields = sendFoxConf => {\n  const mappedFields = sendFoxConf?.field_map ? sendFoxConf.field_map.filter(mappedField => (!mappedField.formField && mappedField.sendFoxFormField && sendFoxConf?.default?.allFields?.[sendFoxConf.listId]?.required.indexOf(mappedField.sendFoxFormField) !== -1)) : []\n  if (mappedFields.length > 0) {\n    return false\n  }\n\n  return true\n}\n\n// another\n\nexport const generateListMappedField = (sendFoxConf) => {\n  const requiredFlds = sendFoxConf?.listFields.filter(fld => fld.required === true)\n  return requiredFlds.length > 0 ? requiredFlds.map(field => ({ formField: '', sendFoxListFormField: field.key })) : [{ formField: '', sendFoxListFormField: '' }]\n}\n\nexport const checkMappedListFields = sendFoxConf => {\n  const mappedFields = sendFoxConf?.field_map_list ? sendFoxConf.field_map_list.filter(mappedField => (!mappedField.formField && mappedField.sendFoxListFormField && sendFoxConf?.default?.allFields?.[sendFoxConf.listId]?.required.indexOf(mappedField.sendFoxListFormField) !== -1)) : []\n  if (mappedFields.length > 0) {\n    return false\n  }\n\n  return true\n}\n\nexport const generateunsubscribeMappedField = (sendFoxConf) => {\n  const requiredFlds = sendFoxConf?.unsubscribeFields.filter(fld => fld.required === true)\n  return requiredFlds.length > 0 ? requiredFlds.map(field => ({ formField: '', sendFoxUnsubscribeFormField: field.key })) : [{ formField: '', sendFoxUnsubscribeFormField: '' }]\n}\n\nexport const checkMappedSubscribeFields = sendFoxConf => {\n  const mappedFields = sendFoxConf?.field_map_unsubscribe ? sendFoxConf.field_map_unsubscribe.filter(mappedField => (!mappedField.formField && mappedField.sendFoxUnsubscribeFormField && sendFoxConf?.default?.allFields?.[sendFoxConf.listId]?.required.indexOf(mappedField.sendFoxUnsubscribeFormField) !== -1)) : []\n  if (mappedFields.length > 0) {\n    return false\n  }\n\n  return true\n}\n\n// eslint-disable-next-line no-nested-ternary\nexport const isDisabled = sendFoxConf => (sendFoxConf.mainAction === '1' ? !checkMappedListFields(sendFoxConf) : (sendFoxConf.mainAction === '2' ? (!checkMappedFields(sendFoxConf) || sendFoxConf.listId === undefined || sendFoxConf.listId === '') : !checkMappedSubscribeFields(sendFoxConf)))\n"],"names":["__","bitsFetch","_t","handleInput","sendFoxConf","setSendFoxConf","setIsLoading","setSnackbar","formID","newConf","__spreadValues","name","fetchAllList","requestParams","result","toast","handleAuthorize","confTmp","setConf","setError","setisAuthorized","generateMappedField","requiredFlds","fld","field","checkMappedFields","mappedField","_a","_b","_c","generateListMappedField","checkMappedListFields","generateunsubscribeMappedField","checkMappedSubscribeFields","isDisabled"],"mappings":"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"}