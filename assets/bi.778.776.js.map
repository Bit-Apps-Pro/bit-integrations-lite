{"version":3,"file":"bi.778.776.js","sources":["../frontend-dev/src/components/AllIntegrations/FluentSupport/FluentSupportCommonFunc.js"],"sourcesContent":["import bitsFetch from \"../../../Utils/bitsFetch\";\nimport { deepCopy } from \"../../../Utils/Helpers\";\nimport { sprintf, __ } from \"../../../Utils/i18nwrap\";\n\nexport const handleInput = (\n  e,\n  fluentSupportConf,\n  setFluentSupportConf,\n  formID,\n  setIsLoading,\n  setSnackbar,\n  isNew,\n  error,\n  setError\n) => {\n  const newConf = { ...fluentSupportConf };\n  if (isNew) {\n    const rmError = { ...error };\n    rmError[e.target.name] = \"\";\n    setError({ ...rmError });\n  }\n  newConf[e.target.name] = e.target.value;\n  setFluentSupportConf({ ...newConf });\n};\n\nexport const supportStaff = (\n  formID,\n  fluentSupportConf,\n  setFluentSupportConf,\n  setIsLoading,\n  setSnackbar\n) => {\n  setIsLoading(true);\n  const refreshSupportStaffRequestParams = {\n    formID,\n    password: fluentSupportConf.password,\n    userName: fluentSupportConf.userName,\n  };\n  bitsFetch(\n    refreshSupportStaffRequestParams,\n    \"fluent_support_get_all_support_staff\"\n  )\n    .then((result) => {\n      if (result && result.success) {\n        const newConf = { ...fluentSupportConf };\n        if (!newConf.default) {\n          newConf.default = {};\n        }\n        if (result.data) {\n          newConf.default.agents = result.data;\n        }\n        setSnackbar({\n          show: true,\n          msg: __(\"Support Staff refreshed\", \"bit-integrations\"),\n        });\n        setFluentSupportConf({ ...newConf });\n      } else {\n        setSnackbar({\n          show: true,\n          msg: __(\n            \"Support Staff refresh failed. please try again\",\n            \"bit-integrations\"\n          ),\n        });\n      }\n      setIsLoading(false);\n    })\n    .catch(() => setIsLoading(false));\n};\n\nexport const getAllBusinessInboxes = (\n  formID,\n  fluentSupportConf,\n  setFluentSupportConf,\n  setIsLoading,\n  setSnackbar\n) => {\n  setIsLoading(true);\n  \n  bitsFetch('',\"fluent_support_get_all_business_inboxes\")\n    .then((result) => {\n      if (result && result.success) {\n        const newConf = { ...fluentSupportConf };\n        if (!newConf.default) {\n          newConf.default = {};\n        }\n        if (result.data) {\n          newConf.default.businessInboxes = result.data;\n        }\n        setSnackbar({\n          show: true,\n          msg: __(\"Business Inboxes refreshed\", \"bit-integrations\"),\n        });\n        setFluentSupportConf({ ...newConf });\n      } else {\n        setSnackbar({\n          show: true,\n          msg: __(\n            \"Business Inboxes refresh failed. please try again\",\n            \"bit-integrations\"\n          ),\n        });\n      }\n      setIsLoading(false);\n    })\n    .catch(() => setIsLoading(false));\n};\n\nexport const generateMappedField = (fluentSupportConf) => {\n  const requiredFlds = fluentSupportConf?.fluentSupportFields.filter(\n    (fld) => fld.required === true\n  );\n  return requiredFlds.length > 0\n    ? requiredFlds.map((field) => ({\n        formField: \"\",\n        fluentSupportFormField: field.key,\n      }))\n    : [{ formField: \"\", fluentSupportFormField: \"\" }];\n};\n\nexport const checkMappedFields = (fluentSupportConf) => {\n  const mappedFields = fluentSupportConf?.field_map\n    ? fluentSupportConf.field_map.filter(\n        (mappedField) =>\n          !mappedField.formField ||\n          !mappedField.fluentSupportFormField ||\n          (!mappedField.formField === \"custom\" && !mappedField.customValue)\n      )\n    : [];\n  if (mappedFields.length > 0) {\n    return false;\n  }\n  return true;\n};\n\nexport const handleAuthorize = (\n  confTmp,\n  setConf,\n  setError,\n  setisAuthorized,\n  setIsLoading,\n  setSnackbar\n) => {\n  setError({});\n  setIsLoading(true);\n\n  bitsFetch(null, \"fluentSupport_authorization\")\n    .then((result) => result)\n    .then((result) => {\n      if (result && result.success) {\n        const newConf = { ...confTmp };\n        setConf(newConf);\n        setisAuthorized(true);\n        setSnackbar({\n          show: true,\n          msg: __(\"Connected Successfully\", \"bit-integrations\"),\n        });\n      } else if (\n        (result && result.data && result.data.data) ||\n        (!result.success && typeof result.data === \"string\")\n      ) {\n        setSnackbar({\n          show: true,\n          msg: `${__(\"Cunnection failed Cause:\", \"bit-integrations\")}${\n            result.data.data || result.data\n          }. ${__(\"please try again\", \"bit-integrations\")}`,\n        });\n      } else {\n        setSnackbar({\n          show: true,\n          msg: __(\"Cunnection failed. please try again\", \"bit-integrations\"),\n        });\n      }\n      setIsLoading(false);\n    });\n};\n"],"names":["bitsFetch","__","handleInput","e","fluentSupportConf","setFluentSupportConf","formID","setIsLoading","setSnackbar","isNew","error","setError","newConf","__spreadValues","rmError","supportStaff","refreshSupportStaffRequestParams","result","getAllBusinessInboxes","generateMappedField","requiredFlds","fld","field","checkMappedFields","mappedField","handleAuthorize","confTmp","setConf","setisAuthorized"],"mappings":"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"}