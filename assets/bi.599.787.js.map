{"version":3,"file":"bi.599.787.js","sources":["../frontend-dev/src/components/AllIntegrations/Vbout/VboutCommonFunc.js"],"sourcesContent":["/* eslint-disable no-else-return */\nimport toast from 'react-hot-toast'\nimport { __ } from '../../../Utils/i18nwrap'\nimport bitsFetch from '../../../Utils/bitsFetch'\nimport { create } from 'mutative'\n\nexport const handleInput = (e, vboutConf, setVboutConf) => {\n  setVboutConf(prevConf => create(prevConf, (draftConfig) => {\n    const { name } = e.target\n    if (e.target.value !== '') {\n      draftConfig[name] = e.target.value\n    } else {\n      delete draftConfig[name]\n    }\n  }))\n}\n\n\n\nexport const generateMappedField = (vboutConf) => {\n  const requiredFlds = vboutConf?.VboutFields.filter(fld => fld.required === true)\n  return requiredFlds.length > 0 ? requiredFlds.map(field => ({ formField: '', VboutFormField: field.key })) : [{ formField: '', VboutFormField: '' }]\n}\n\nexport const checkMappedFields = (vboutConf) => {\n  const mappedFields = vboutConf?.field_map ? vboutConf.field_map.filter(mappedField => (!mappedField.formField || !mappedField.VboutFormField || (!mappedField.formField === 'custom' && !mappedField.customValue))) : []\n  if (mappedFields.length > 0) {\n    return false\n  }\n  return true\n}\nexport const handleAuthorize = (confTmp, setConf, setError, setisAuthorized, loading, setLoading) => {\n  if (!confTmp.auth_token) {\n    setError({ auth_token: !confTmp.auth_token ? __('Api Key can\\'t be empty', 'bit-integrations') : '' })\n    return\n  }\n  setError({})\n  setLoading({ ...loading, auth: true })\n\n\n  const requestParams = { auth_token: confTmp.auth_token }\n  bitsFetch(requestParams, 'vbout_handle_authorize')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...confTmp }\n        setConf(newConf)\n        setisAuthorized(true)\n        setLoading({ ...loading, auth: false })\n        toast.success(__('Authorized successfully', 'bit-integrations'))\n        return\n      }\n      setLoading({ ...loading, auth: false })\n      toast.error(__('Authorized failed', 'bit-integrations'))\n    })\n}\n\n\nexport const VboutRefreshFields = (confTmp, setConf, loading, setLoading) => {\n  setLoading({ ...loading, field: true })\n\n  const requestParams = { auth_token: confTmp.auth_token, list_id: confTmp.list_id }\n\n  bitsFetch(requestParams, 'vbout_refresh_fields')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...confTmp }\n        if (result.data) {\n          newConf.VboutFields = result.data\n        }\n        newConf['field_map'] = generateMappedField(newConf)\n        setConf(newConf)\n        setLoading({ ...loading, field: false })\n        toast.success(__('Fields refresh successfully', 'bit-integrations'))\n        return\n      }\n      setLoading({ ...loading, field: false })\n      toast.error(__('Fields refresh failed', 'bit-integrations'))\n    })\n}\n\nexport const getAllLists = (confTmp, setConf, loading, setLoading,) => {\n  setLoading({ ...loading, list: true })\n\n  const requestParams = { auth_token: confTmp.auth_token }\n\n  bitsFetch(requestParams, 'vbout_fetch_all_lists')\n    .then(result => {\n      if (result && result.success) {\n        const newConf = { ...confTmp }\n        if (result.data) {\n          if (!newConf.default) {\n            newConf.default = {}\n          }\n          newConf.default.lists = result.data\n        }\n        setConf(newConf)\n        setLoading({ ...loading, list: false })\n\n        toast.success(__('List refresh successfully', 'bit-integrations'))\n        return\n      }\n      setLoading({ ...loading, list: false })\n      toast.error(__('List refresh failed', 'bit-integrations'))\n    })\n\n}\n"],"names":["__","bitsFetch","_t","create","handleInput","vboutConf","setVboutConf","prevConf","draftConfig","name","generateMappedField","requiredFlds","fld","field","checkMappedFields","mappedField","handleAuthorize","confTmp","setConf","setError","setisAuthorized","loading","setLoading","__spreadProps","__spreadValues","requestParams","result","newConf","toast","VboutRefreshFields","getAllLists"],"mappings":"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"}